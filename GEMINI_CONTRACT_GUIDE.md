# Working with Gemini-Generated Smart Contracts

This guide provides a comprehensive overview of how to effectively work with smart contracts generated by Gemini AI in the Avalanche system.

## Overview

Gemini AI is capable of generating smart contracts based on natural language prompts. However, these contracts might contain certain issues that need to be fixed before they can be deployed on the Avalanche network. Our system provides tools to automatically fix and compile these contracts.

## Common Issues with Gemini-Generated Contracts

1. **Missing SPDX License Identifiers**: Gemini may forget to include the license identifier at the top of the contract.
2. **Incompatible Solidity Versions**: The specified pragma version may not be compatible with our compiler.
3. **Import Path Issues**: Imports may use incorrect or incompatible paths.
4. **Inline Documentation Artifacts**: Markdown code block markers or comments that interfere with compilation.
5. **Missing Dependencies**: References to contracts or libraries without proper imports.

## Our Solution

The Avalanche system provides a comprehensive solution to these issues through:

1. **Automatic Contract Fixing**: Pre-processes contracts to fix common issues.
2. **Dependency Resolution**: Automatically resolves OpenZeppelin imports.
3. **Compilation**: Uses Hardhat for reliable compilation with detailed error messages.
4. **Frontend Integration**: A user-friendly interface to process Gemini-generated contracts.

## Using the Gemini Processor

### Option 1: Web Interface

1. Navigate to the "Gemini Processor" page in the Avalanche web application.
2. Paste the contract generated by Gemini into the input area.
3. Click "Fix Contract Only" to just preprocess the contract without compiling.
4. Click "Fix & Compile Contract" to preprocess and compile in one step.

### Option 2: API Endpoints

Our backend provides two main endpoints for processing Gemini contracts:

#### Fix Contract Only
```
POST /api/gemini/fix
Content-Type: application/json
{
  "contractCode": "// Your Gemini-generated contract here"
}

Response:
{
  "success": true,
  "fixedCode": "// Fixed contract code"
}
```

#### Fix and Compile Contract
```
POST /api/gemini/compile
Content-Type: application/json
{
  "contractCode": "// Your Gemini-generated contract here"
}

Response:
{
  "success": true,
  "result": {
    "abi": [...],
    "bytecode": "0x...",
    "fixedCode": "// Fixed contract code"
  }
}
```

## Prompting Best Practices

When asking Gemini to generate contracts, use these best practices to get better results:

1. **Be Specific**: Clearly describe the contract's purpose and functionality.
2. **Specify Version**: Ask for contracts using Solidity ^0.8.0.
3. **Mention OpenZeppelin**: If you want to use OpenZeppelin contracts, explicitly mention it.
4. **Request Comments**: Ask for well-commented code to improve readability.
5. **Ask for Security Measures**: Request built-in security features like reentrancy guards.

### Example Prompt

```
Generate a smart contract for a simple NFT marketplace on Avalanche.

Requirements:
- Use Solidity ^0.8.0
- Include OpenZeppelin contracts for ERC721 and security features
- Allow users to list NFTs for sale
- Enable purchasing of listed NFTs
- Include admin functionality to pause the market if needed
- Add detailed comments explaining functionality
- Implement security best practices
```

## Supported OpenZeppelin Contracts

Our system automatically resolves imports for these commonly used OpenZeppelin contracts:

- ERC20 (`@openzeppelin/contracts/token/ERC20/ERC20.sol`)
- ERC721 (`@openzeppelin/contracts/token/ERC721/ERC721.sol`)
- ERC721URIStorage (`@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol`)
- ERC1155 (`@openzeppelin/contracts/token/ERC1155/ERC1155.sol`)
- Ownable (`@openzeppelin/contracts/access/Ownable.sol`)
- Counters (`@openzeppelin/contracts/utils/Counters.sol`)
- Strings (`@openzeppelin/contracts/utils/Strings.sol`)
- ReentrancyGuard (`@openzeppelin/contracts/security/ReentrancyGuard.sol`)
- Pausable (`@openzeppelin/contracts/security/Pausable.sol`)

## Troubleshooting

If you encounter issues with Gemini-generated contracts:

1. **Check Compilation Errors**: Read the error messages carefully to understand what went wrong.
2. **Examine the Fixed Code**: Compare the original and fixed contract to see what changes were made.
3. **Manual Fixes**: For complex issues, you may need to manually edit the contract code.
4. **Contact Support**: For persistent issues, reach out to the Avalanche support team.

## Conclusion

The Gemini Contract Processor is designed to make working with AI-generated contracts as seamless as possible. By automating the fixing and compilation process, we enable you to focus on designing and deploying innovative smart contracts on the Avalanche network.