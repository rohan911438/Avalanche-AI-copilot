# Gemini Contract Processor for Avalanche

This project provides a complete system for processing, fixing, and compiling smart contracts generated by Google's Gemini AI. The system handles common issues with AI-generated contracts and makes them ready for deployment on the Avalanche blockchain.

## Overview

AI language models like Gemini can generate smart contracts from natural language descriptions, but these contracts often have issues that prevent them from compiling correctly. This system automatically fixes those issues and prepares the contracts for deployment.

## Key Features

- **Automatic Import Resolution**: Detects and adds missing imports for OpenZeppelin contracts
- **SPDX License Addition**: Adds missing license identifiers
- **Pragma Solidity Fixes**: Ensures compatible Solidity version
- **Markdown Cleanup**: Removes code block artifacts from Gemini outputs
- **API Endpoints**: Easy-to-use API endpoints for integration
- **Web Interface**: User-friendly interface for working with Gemini contracts

## Directory Structure

```
backend/
  ├── gemini-contract-fixer.js     # Core utility for fixing Gemini contracts
  ├── contractCompiler.js          # Basic Solidity compiler
  ├── hardhatCompiler.js           # Hardhat-based compiler for better error messages
  ├── routes/
  │   └── api-gemini-processor.js  # API endpoints for the Gemini processor
  └── test-output/                 # Output directory for tests
  
avalanche-frontend/
  └── src/
      ├── app/
      │   ├── gemini-processor/    # Page for the Gemini processor
      │   └── components/
      │       └── GeminiContractProcessor.jsx  # React component for Gemini contract processing
```

## API Endpoints

### Fix Contract
```
POST /api/gemini/fix
Content-Type: application/json
{
  "contractCode": "// Contract code from Gemini"
}
```

### Fix and Compile Contract
```
POST /api/gemini/compile
Content-Type: application/json
{
  "contractCode": "// Contract code from Gemini"
}
```

## Web Interface

The system includes a web interface at `/gemini-processor` where users can:

1. Paste Gemini-generated contract code
2. Click "Fix Contract Only" to just fix common issues
3. Click "Fix & Compile Contract" to fix and compile in one step

## Common Issues Fixed

1. **Missing SPDX License**: Gemini may forget to include the SPDX license identifier.
2. **Incompatible Solidity Version**: The specified pragma version might not be compatible.
3. **Import Path Issues**: Imports may use incorrect or incompatible paths.
4. **Markdown Artifacts**: Code block markers and other markdown artifacts.
5. **Missing Dependencies**: References to contracts or libraries without proper imports.

## Supported OpenZeppelin Contracts

The system automatically handles imports for these common OpenZeppelin contracts:

- ERC20 (`@openzeppelin/contracts/token/ERC20/ERC20.sol`)
- ERC721 (`@openzeppelin/contracts/token/ERC721/ERC721.sol`)
- ERC721URIStorage (`@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol`)
- ERC1155 (`@openzeppelin/contracts/token/ERC1155/ERC1155.sol`)
- Ownable (`@openzeppelin/contracts/access/Ownable.sol`)
- Counters (`@openzeppelin/contracts/utils/Counters.sol`)
- Strings (`@openzeppelin/contracts/utils/Strings.sol`)
- ReentrancyGuard (`@openzeppelin/contracts/security/ReentrancyGuard.sol`)
- Pausable (`@openzeppelin/contracts/security/Pausable.sol`)

## Getting Started

1. **Start the Backend**:
   ```
   cd backend
   npm install
   npm start
   ```

2. **Start the Frontend**:
   ```
   cd avalanche-frontend
   npm install
   npm run dev
   ```

3. **Access the Web Interface**: Open your browser and navigate to `http://localhost:3000/gemini-processor`

## Best Practices for Generating Contracts with Gemini

When asking Gemini to generate smart contracts, follow these best practices:

1. **Be Specific**: Clearly describe the contract's purpose and functionality
2. **Specify Version**: Ask for contracts using Solidity ^0.8.0
3. **Mention OpenZeppelin**: If you want to use OpenZeppelin contracts, explicitly mention it
4. **Request Comments**: Ask for well-commented code to improve readability
5. **Ask for Security Measures**: Request built-in security features like reentrancy guards

### Example Prompt

```
Generate a smart contract for a simple NFT marketplace on Avalanche.

Requirements:
- Use Solidity ^0.8.0
- Include OpenZeppelin contracts for ERC721 and security features
- Allow users to list NFTs for sale
- Enable purchasing of listed NFTs
- Include admin functionality to pause the market if needed
- Add detailed comments explaining functionality
- Implement security best practices
```

## Additional Resources

- [GEMINI_CONTRACT_GUIDE.md](./GEMINI_CONTRACT_GUIDE.md): Comprehensive guide for working with Gemini-generated contracts
- [FRONTEND_INTEGRATION_GUIDE.md](./FRONTEND_INTEGRATION_GUIDE.md): Guide for integrating the Gemini processor into frontend applications

## Troubleshooting

If you encounter issues with Gemini-generated contracts:

1. **Check Compilation Errors**: Read the error messages carefully
2. **Examine the Fixed Code**: Compare the original and fixed contract
3. **Manual Fixes**: For complex issues, manually edit the contract code
4. **Check Imports**: Verify that all necessary imports are properly resolved